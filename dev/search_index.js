var documenterSearchIndex = {"docs":
[{"location":"coords/#Compare-Coordinate-Transformations-with-IRBEM-and-PySPEDAS","page":"Validation & Comparison","title":"Compare Coordinate Transformations with IRBEM and PySPEDAS","text":"note: Takeaway\nJulia's implementation yields results very close to IRBEM's and PySPEDAS's one, and is an order of magnitude faster. (Julia's one uses finer interpolation than IRBEM's and PySPEDAS's one to determine IGRF coefficients and sun's direction, leading to more accurate transformations.)\n\nSee Coordinate Systems for more information about integration with SPEDAS.jl.\n\nReferences: test_cotrans.py - PySPEDAS","category":"section"},{"location":"coords/#Setup","page":"Validation & Comparison","title":"Setup","text":"details: Setup library dependencies\nusing GeoCotrans\nusing PySPEDAS\nusing PySPEDAS.PythonCall\nusing DimensionalData\nusing Chairmarks\nusing Test\nusing IRBEM\n\nfunction irbem_cotrans(pos, in, out)\n    IRBEM.transform(pos.dims[1].val, pos.data', in, out)'\nend\n\nUsing data from PySPEDAS test cases.\n\n@py import pyspedas.cotrans_tools.tests.test_cotrans: CotransTestCases\n\npytest = CotransTestCases()\npytest.test_cotrans()\n\ntrange = [\"2010-02-25/00:00:00\", \"2010-02-25/23:59:59\"]\npyspedas.projects.themis.state(trange, probe=\"a\", time_clip=true)\n\ntha_pos = PySPEDAS.get_data(\"tha_pos\") |> DimArray\ntha_pos_gse = PySPEDAS.get_data(\"tha_pos_gse\") |> DimArray\njl_tha_pos = set(tha_pos, Dim{:time}=>Ti)\njl_tha_pos_gse = set(tha_pos_gse, Dim{:time}=>Ti)","category":"section"},{"location":"coords/#Validation","page":"Validation & Comparison","title":"Validation","text":"Transform coordinates using Julia native implementation, IRBEM, and PySPEDAS.\n\nGEI <-> GEO\n\njl_tha_pos_geo = gei2geo(jl_tha_pos)\nir_tha_pos_geo = irbem_cotrans(jl_tha_pos, \"GEI\", \"GEO\")\npy_tha_pos_geo = PySPEDAS.get_data(\"tha_pos_new_geo\")\n\n@assert jl_tha_pos_geo â‰ˆ parent(py_tha_pos_geo)\n@assert jl_tha_pos_geo â‰ˆ ir_tha_pos_geo\n\nGEI <-> GSM\n\njl_tha_pos_gsm = gei2gsm(jl_tha_pos)\nir_tha_pos_gsm = irbem_cotrans(jl_tha_pos, \"GEI\", \"GSM\")\npyspedas.cotrans(\"tha_pos\", \"tha_pos_new_gsm\", coord_in=\"GEI\", coord_out=\"GSM\")\npy_tha_pos_gsm = PySPEDAS.get_data(\"tha_pos_new_gsm\")\n\n@test isapprox(jl_tha_pos_gsm, parent(py_tha_pos_gsm), rtol=1e-5)\n@test isapprox(jl_tha_pos_gsm, ir_tha_pos_gsm, rtol=1e-3)\n\nGSE <-> GSM\n\njl_tha_pos_gsm = gse2gsm(jl_tha_pos_gse)\nir_tha_pos_gsm = irbem_cotrans(jl_tha_pos_gse, \"GSE\", \"GSM\")\npyspedas.cotrans(\"tha_pos_gse\", \"tha_pos_new_gsm\", coord_in=\"GSE\", coord_out=\"GSM\")\npy_tha_pos_gsm = PySPEDAS.get_data(\"tha_pos_new_gsm\")\n\n@test isapprox(jl_tha_pos_gsm, parent(py_tha_pos_gsm), rtol=1e-5)\n@test isapprox(jl_tha_pos_gsm, ir_tha_pos_gsm, rtol=1e-3)\n\nValidate results: GEI/GEO transformations is quite accurate, while there are some differences in GSE/GSM transformations between Julia native implementation and IRBEM's one.","category":"section"},{"location":"coords/#Benchmark","page":"Validation & Comparison","title":"Benchmark","text":"Depends on the transformation, Julia's implementation is about 10-40 times faster than IRBEM's (Fortran) implementation, and 20-50 times faster than PySPEDAS's (Python) implementation.\n\n@b gei2geo($jl_tha_pos), irbem_cotrans($jl_tha_pos, \"GEI\", \"GEO\"), pyspedas.cotrans(\"tha_pos\", \"tha_pos_new_geo\", coord_in=\"GEI\", coord_out=\"GEO\")\n\n@b gei2gsm($jl_tha_pos), irbem_cotrans($jl_tha_pos, \"GEI\", \"GSM\"), pyspedas.cotrans(\"tha_pos\", \"tha_pos_new_gsm\", coord_in=\"GEI\", coord_out=\"GSM\")\n\n@b gse2gsm($jl_tha_pos_gse), irbem_cotrans($jl_tha_pos_gse, \"GSE\", \"GSM\"), pyspedas.cotrans(\"tha_pos_gse\", \"tha_pos_new_gsm\", coord_in=\"GSE\", coord_out=\"GSM\")","category":"section"},{"location":"field_line_tracing/#Field-Line-Tracing","page":"Field Line Tracing","title":"Field Line Tracing","text":"","category":"section"},{"location":"field_line_tracing/#Basic-Usage","page":"Field Line Tracing","title":"Basic Usage","text":"using GeoCotrans, OrdinaryDiffEqTsit5, Dates\n\n# Define time for field evaluation\nt = DateTime(2020, 1, 1)\n\n# Trace a field line starting from [3, 0, 0] Earth radii (GEO coordinates)\nsol = trace(GEO(3.0, 0.0, 0.0), t, Tsit5())","category":"section"},{"location":"field_line_tracing/#Plotting-with-Makie","page":"Field Line Tracing","title":"Plotting with Makie","text":"Here's a complete example showing how to trace and visualize magnetic field lines using GLMakie:\n\nusing GeoCotrans, OrdinaryDiffEqTsit5, Dates\nusing CairoMakie\n\n# Time for field evaluation\nt = DateTime(2020, 1, 1)\n\n# Create figure\nfig = Figure(size = (800, 800))\nax = Axis3(fig[1, 1],\n    xlabel = \"X (Re)\",\n    ylabel = \"Y (Re)\",\n    zlabel = \"Z (Re)\",\n    title = \"IGRF Field Lines at $(Date(t))\",\n    aspect = :data\n)\n\n# Draw Earth (unit sphere)\nÎ¸_sphere = range(0, Ï€, length=30)\nÏ†_sphere = range(0, 2Ï€, length=60)\nx_sphere = [sin(Î¸) * cos(Ï†) for Î¸ in Î¸_sphere, Ï† in Ï†_sphere]\ny_sphere = [sin(Î¸) * sin(Ï†) for Î¸ in Î¸_sphere, Ï† in Ï†_sphere]\nz_sphere = [cos(Î¸) for Î¸ in Î¸_sphere, Ï† in Ï†_sphere]\nsurface!(ax, x_sphere, y_sphere, z_sphere, color = :lightblue, alpha = 0.8)\n\n# Trace field lines from different starting positions\nL_values = [2.0, 3.0, 4.0, 5.0]  # L-shell values\ncolors = [:red, :orange, :green, :blue]\n\nfor (L, color) in zip(L_values, colors)\n    # Trace in both directions from the equator\n    for dir in [1, -1]\n        sol = trace(GEO(L, 0.0, 0.0), t, Tsit5(); dir = dir)\n        # Plot the field line\n        plot!(ax, sol; color = color, linewidth = 2, idxs = (1, 2, 3),\n            label = dir == 1 ? \"L = $L\" : nothing)\n    end\nend\n\naxislegend(ax, position = :rt) # Add legend\nlimits!(ax, -6, 6, -6, 6, -6, 6) # Set view limits\n\nfig","category":"section"},{"location":"field_line_tracing/#2D-Visualization","page":"Field Line Tracing","title":"2D Visualization","text":"using GeoCotrans, OrdinaryDiffEqTsit5, Dates\nusing CairoMakie\n\nt = DateTime(2020, 1, 1)\n\nfig = Figure(size = (1000, 500))\n\n# Left panel: Meridional plane (X-Z)\nax1 = Axis(fig[1, 1],\n    xlabel = \"X (Re)\", ylabel = \"Z (Re)\",\n    title = \"Field Lines in Meridional Plane\",\n    aspect = DataAspect()\n)\n\n# Draw Earth cross-section\nÎ¸_circle = range(0, 2Ï€, length=100)\nlines!(ax1, cos.(Î¸_circle), sin.(Î¸_circle), color = :lightblue, linewidth = 3)\n\n# Trace field lines\nfor L in [2.0, 3.0, 4.0, 5.0, 6.0]\n    for dir in [1, -1]\n        sol = trace(GEO(L, 0.0, 0.0), t, Tsit5(); dir = dir)\n        lines!(ax1, sol, idxs = (1, 3), color = :darkblue, linewidth = 1.5)\n    end\nend\n\nlimits!(ax1, -7, 7, -7, 7)\n\n# Right panel: Equatorial plane (X-Y)\nax2 = Axis(fig[1, 2],\n    xlabel = \"X (Re)\", ylabel = \"Y (Re)\",\n    title = \"Field Lines in Equatorial Plane\",\n    aspect = DataAspect()\n)\n\n# Draw Earth cross-section\nlines!(ax2, cos.(Î¸_circle), sin.(Î¸_circle), color = :lightblue, linewidth = 3)\n\n# Starting points slightly off equator to see field line structure\nfor L in [3.0, 4.0, 5.0]\n    for Ï† in range(0, 2Ï€, length=13)[1:12]\n        y0, x0 = L .* sincos(Ï†)\n        # Start slightly above equator\n        sol = trace(GEO(x0, y0, 0.1), t, Tsit5(); dir = 1)\n        lines!(ax2, sol, idxs = (1, 2), color = :darkgreen, linewidth = 1)\n    end\nend\n\nlimits!(ax2, -7, 7, -7, 7)\n\nfig","category":"section"},{"location":"field_line_tracing/#API-Reference","page":"Field Line Tracing","title":"API Reference","text":"","category":"section"},{"location":"field_line_tracing/#GeoCotrans.FieldLineTracing-field_line_tracing","page":"Field Line Tracing","title":"GeoCotrans.FieldLineTracing","text":"GeoCotrans.jl provides functionality to trace magnetic field lines.\n\nThis feature is provided via a package extension and requires an ODE solver package to be loaded in the active environment. For example, load OrdinaryDiffEqTsit5 (or another SciML ODE solver) before calling trace.\n\nAPI\n\ntrace, FieldLineProblem, FieldLineCallback\n\n\n\n\n\n","category":"module"},{"location":"field_line_tracing/#GeoCotrans.FieldLineTracing.FieldLineProblem-field_line_tracing","page":"Field Line Tracing","title":"GeoCotrans.FieldLineTracing.FieldLineProblem","text":"FieldLineProblem(pos, tspan, t; model=IGRF(), dir=1)\n\nCreate an ODEProblem for tracing a magnetic field line in model at time t.\n\ndir::Int = 1: Tracing direction (+1 for parallel to B, -1 for anti-parallel)\n\nExample\n\nusing GeoCotrans, OrdinaryDiffEqTsit5, Dates\n\nt = DateTime(2020, 1, 1)\npos = [3.0, 0.0, 0.0]\nprob = FieldLineProblem(pos, (0.0, 50.0), t)\nsol = solve(prob, Tsit5())\n\n\n\n\n\n","category":"function"},{"location":"field_line_tracing/#GeoCotrans.FieldLineTracing.FieldLineCallback-field_line_tracing","page":"Field Line Tracing","title":"GeoCotrans.FieldLineTracing.FieldLineCallback","text":"FieldLineCallback(; r0=1.0, rlim=10.0)\n\nCreate a callback for terminating field line integration at boundaries.\n\nKeyword Arguments\n\nr0 = 1.0: Inner radial boundary (Earth radii)\nrlim = 10.0: Outer radial boundary (Earth radii)\n\n\n\n\n\n","category":"function"},{"location":"field_line_tracing/#GeoCotrans.FieldLineTracing.trace-field_line_tracing","page":"Field Line Tracing","title":"GeoCotrans.FieldLineTracing.trace","text":"trace(pos, t, solver; kwargs...) :: ODESolution\n\nTrace a magnetic field line using the specified SciML solver.\n\nKeyword Arguments\n\nmodel = IGRF(): Magnetic field model to use\ndir = 1: Tracing direction (+1 for parallel to B, -1 for anti-parallel)\nr0 = 1.0: Inner radial boundary (Earth radii)\nrlim = 10.0: Outer radial boundary (Earth radii)\nmaxs = 100.0: Maximum arc length for integration\nin = getcsys(pos): Input coordinate system (Reference frame and coordinate representation)\nAdditional keyword arguments are passed to solve()\n\nExample\n\nusing GeoCotrans, OrdinaryDiffEqTsit5\nsol = trace([3.0, 0.0, 0.0], t, Tsit5())\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.jl","page":"Home","title":"GeoCotrans.jl","text":"(Image: DOI) (Image: version)","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"using Pkg\nPkg.add(\"GeoCotrans\")","category":"section"},{"location":"#Usage","page":"Home","title":"Usage","text":"Magnetic Local Time (MLT) calculation\n\nusing GeoCotrans, Dates\n\nxGEO = [1., 2., 3.];\ntime = Date(2020);\nget_mlt(xGEO, time)","category":"section"},{"location":"#Coordinate-Systems","page":"Home","title":"Coordinate Systems","text":"","category":"section"},{"location":"#API-Reference","page":"Home","title":"API Reference","text":"","category":"section"},{"location":"#Public","page":"Home","title":"Public","text":"","category":"section"},{"location":"#Private","page":"Home","title":"Private","text":"","category":"section"},{"location":"#GeoCotrans","page":"Home","title":"GeoCotrans","text":"Coordinate systems, transformations, geomagnetic field models, and field line tracing.\n\nReference frames\n\nGEO: Geocentric Geographic (GEO) reference frame.\nGSM: Geocentric Solar Magnetospheric (GSM) reference frame.\nGSE: Geocentric Solar Ecliptic (GSE) reference frame.\nGEI: Geocentric Equatorial Inertial (GEI) reference frame.\nMAG: Geomagnetic (MAG) reference frame.\nSM: Solar Magnetic (SM) reference frame.\n\nUtility functions for specifying coordinate representaion in GEO reference frames.\n\nGDZ: Geodetic (GDZ) coordinate system (latitude [deg], longitude [deg], altitude [km]).\n\nCoordinate transformations\n\nDirect transformations\n\ngeo2gei, gei2geo: Transform between GEO and GEI reference frames.\ngeo2gsm, gsm2geo: Transform between GEO and GSM reference frames.\ngei2gsm, gsm2gei: Transform between GEI and GSM reference frames.\ngse2gsm, gsm2gse: Transform between GSE and GSM reference frames.\ngeo2mag, mag2geo: Transform between GEO and MAG reference frames.\ngsm2sm, sm2gsm: Transform between GSM and SM reference frames.\n\nChain transformations\n\ngei2sm, sm2gei: Transform between GEI and SM reference frames.\ngeo2sm, sm2geo: Transform between GEO and SM reference frames.\ngei2mag, mag2gei: Transform between GEI and MAG reference frames.\nsph2car, car2sph: Transform between spherical and cartesian coordinate representations.\n\nReferences\n\nCoordinate transformations between geocentric systems\n\nInternational Geomagnetic Reference Field (IGRF)\n\nThe International Geomagnetic Reference Field (IGRF) is a standard mathematical description of the Earth's main magnetic field. It is used widely in studies of the Earth's deep interior, crust, ionosphere, and magnetosphere.\n\nAPI\n\nIGRF / igrf: Compute the geomagnetic field (IGRF-14)\n\nExamples\n\nusing GeoCotrans, Dates\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = Date(2015)\nBr, BÎ¸, BÏ† = igrf(r, Î¸, Ï†, t) # â‰ˆ [-45469, -21942, 2933]\n\n# Input position in geodetic coordinates, output magnetic field in East-North-Up (ENU) coordinates\nlat, lon = 60, 5\nBe, Bn, Bu = igrf(GDZ(lat, lon), t) # [430, 15184, -48864]\n\n# Input position as a matrix in GSM Cartesian coordinates, output magnetic field as a matrix\npos = rand(3, 6)\ntimes = Date.(2015:2020)\nBgsm = igrf(pos, times; in = GSM())\n\nReferences\n\nIAGA - NOAA/NCEI\nIGRF-14 Evaluation\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.FieldLineTracing-index","page":"Home","title":"GeoCotrans.FieldLineTracing","text":"GeoCotrans.jl provides functionality to trace magnetic field lines.\n\nThis feature is provided via a package extension and requires an ODE solver package to be loaded in the active environment. For example, load OrdinaryDiffEqTsit5 (or another SciML ODE solver) before calling trace.\n\nAPI\n\ntrace, FieldLineProblem, FieldLineCallback\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.GEI-index","page":"Home","title":"GeoCotrans.GEI","text":"Geocentric Equatorial Inertial (GEI) reference frame.\n\nTo Construct a CoordinateVector in GEI reference frame with cartesian representation.\n\nGEI(x, y, z, t = nothing)\nGEI(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEO-index","page":"Home","title":"GeoCotrans.GEO","text":"Geocentric Geographic (GEO) reference frame.\n\nTo Construct a CoordinateVector in GEO reference frame with cartesian representation.\n\nGEO(x, y, z, t = nothing)\nGEO(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSM-index","page":"Home","title":"GeoCotrans.GSM","text":"Geocentric Solar Magnetospheric (GSM) reference frame.\n\nX points sunward from Earth's center. The X-Z plane is defined to contain Earth's dipole axis (positive North).\n\nTo Construct a CoordinateVector in GSM reference frame with cartesian representation.\n\nGSM(x, y, z, t = nothing)\nGSM(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSE-index","page":"Home","title":"GeoCotrans.GSE","text":"Geocentric Solar Ecliptic (GSE) reference frame.\n\nTo Construct a CoordinateVector in GSE reference frame with cartesian representation.\n\nGSE(x, y, z, t = nothing)\nGSE(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.MAG-index","page":"Home","title":"GeoCotrans.MAG","text":"Geomagnetic (MAG) reference frame.\n\nZ-axis is parallel to Earth's magnetic dipole axis (positive northward). Y-axis is perpendicular to the plane containing the dipole and Earth's rotation axis.\n\nTo Construct a CoordinateVector in MAG reference frame with cartesian representation.\n\nMAG(x, y, z, t = nothing)\nMAG(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.SM-index","page":"Home","title":"GeoCotrans.SM","text":"Solar Magnetic (SM) reference frame.\n\nTo Construct a CoordinateVector in SM reference frame with cartesian representation.\n\nSM(x, y, z, t = nothing)\nSM(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GDZ-index","page":"Home","title":"GeoCotrans.GDZ","text":"Geodetic (GDZ) coordinate system (latitude [deg], longitude [deg], altitude [km]).\n\nDefined using a reference ellipsoid. Both the altitude and latitude depend on the ellipsoid used. GeoCotrans uses the WGS84 reference ellipsoid.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.GeoCotrans","page":"Home","title":"GeoCotrans.GeoCotrans","text":"Coordinate systems, transformations, geomagnetic field models, and field line tracing.\n\nReference frames\n\nGEO: Geocentric Geographic (GEO) reference frame.\nGSM: Geocentric Solar Magnetospheric (GSM) reference frame.\nGSE: Geocentric Solar Ecliptic (GSE) reference frame.\nGEI: Geocentric Equatorial Inertial (GEI) reference frame.\nMAG: Geomagnetic (MAG) reference frame.\nSM: Solar Magnetic (SM) reference frame.\n\nUtility functions for specifying coordinate representaion in GEO reference frames.\n\nGDZ: Geodetic (GDZ) coordinate system (latitude [deg], longitude [deg], altitude [km]).\n\nCoordinate transformations\n\nDirect transformations\n\ngeo2gei, gei2geo: Transform between GEO and GEI reference frames.\ngeo2gsm, gsm2geo: Transform between GEO and GSM reference frames.\ngei2gsm, gsm2gei: Transform between GEI and GSM reference frames.\ngse2gsm, gsm2gse: Transform between GSE and GSM reference frames.\ngeo2mag, mag2geo: Transform between GEO and MAG reference frames.\ngsm2sm, sm2gsm: Transform between GSM and SM reference frames.\n\nChain transformations\n\ngei2sm, sm2gei: Transform between GEI and SM reference frames.\ngeo2sm, sm2geo: Transform between GEO and SM reference frames.\ngei2mag, mag2gei: Transform between GEI and MAG reference frames.\nsph2car, car2sph: Transform between spherical and cartesian coordinate representations.\n\nReferences\n\nCoordinate transformations between geocentric systems\n\nInternational Geomagnetic Reference Field (IGRF)\n\nThe International Geomagnetic Reference Field (IGRF) is a standard mathematical description of the Earth's main magnetic field. It is used widely in studies of the Earth's deep interior, crust, ionosphere, and magnetosphere.\n\nAPI\n\nIGRF / igrf: Compute the geomagnetic field (IGRF-14)\n\nExamples\n\nusing GeoCotrans, Dates\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = Date(2015)\nBr, BÎ¸, BÏ† = igrf(r, Î¸, Ï†, t) # â‰ˆ [-45469, -21942, 2933]\n\n# Input position in geodetic coordinates, output magnetic field in East-North-Up (ENU) coordinates\nlat, lon = 60, 5\nBe, Bn, Bu = igrf(GDZ(lat, lon), t) # [430, 15184, -48864]\n\n# Input position as a matrix in GSM Cartesian coordinates, output magnetic field as a matrix\npos = rand(3, 6)\ntimes = Date.(2015:2020)\nBgsm = igrf(pos, times; in = GSM())\n\nReferences\n\nIAGA - NOAA/NCEI\nIGRF-14 Evaluation\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.CoordinateVector","page":"Home","title":"GeoCotrans.CoordinateVector","text":"CoordinateVector{F, T}\n\n3-element FieldVector in a specific coordinate frame F using representation R.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEI","page":"Home","title":"GeoCotrans.GEI","text":"Geocentric Equatorial Inertial (GEI) reference frame.\n\nTo Construct a CoordinateVector in GEI reference frame with cartesian representation.\n\nGEI(x, y, z, t = nothing)\nGEI(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEO","page":"Home","title":"GeoCotrans.GEO","text":"Geocentric Geographic (GEO) reference frame.\n\nTo Construct a CoordinateVector in GEO reference frame with cartesian representation.\n\nGEO(x, y, z, t = nothing)\nGEO(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSE","page":"Home","title":"GeoCotrans.GSE","text":"Geocentric Solar Ecliptic (GSE) reference frame.\n\nTo Construct a CoordinateVector in GSE reference frame with cartesian representation.\n\nGSE(x, y, z, t = nothing)\nGSE(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSM","page":"Home","title":"GeoCotrans.GSM","text":"Geocentric Solar Magnetospheric (GSM) reference frame.\n\nX points sunward from Earth's center. The X-Z plane is defined to contain Earth's dipole axis (positive North).\n\nTo Construct a CoordinateVector in GSM reference frame with cartesian representation.\n\nGSM(x, y, z, t = nothing)\nGSM(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.IGRF","page":"Home","title":"GeoCotrans.IGRF","text":"IGRF(;)\n\nLoad the International Geomagnetic Reference Field (IGRF) model.\n\nIGRF is a time-varying model of Earth's main magnetic field with coefficients at 5-year epochs from 1965 to 2030, linearly interpolated between epochs.\n\nBy default the input coordinate system in is (GEO(), Spherical()).\n\nExamples\n\nm = IGRF()\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = DateTime(\"2021-03-28\")\nm(r, Î¸, Ï†, t)\n\n# When input is in different coordinate system, specify `in` or decorate the input\n# By default, the output for GDZ input is (Be, Bn, Bu) in East-North-Up (ENU) frame\nlat, lon = 60.39299, 5.32415\nm2 = IGRF(; in = GDZ())\nm2(lat, lon, 0, t)\nm(GDZ(lat, lon, 0), t)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.MAG","page":"Home","title":"GeoCotrans.MAG","text":"Geomagnetic (MAG) reference frame.\n\nZ-axis is parallel to Earth's magnetic dipole axis (positive northward). Y-axis is perpendicular to the plane containing the dipole and Earth's rotation axis.\n\nTo Construct a CoordinateVector in MAG reference frame with cartesian representation.\n\nMAG(x, y, z, t = nothing)\nMAG(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.SM","page":"Home","title":"GeoCotrans.SM","text":"Solar Magnetic (SM) reference frame.\n\nTo Construct a CoordinateVector in SM reference frame with cartesian representation.\n\nSM(x, y, z, t = nothing)\nSM(ð«, t = nothing)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GDZ","page":"Home","title":"GeoCotrans.GDZ","text":"GDZ(Ï•, Î», h)\n\nGeodetic coordinate system with:\n\nÏ•: latitude (north/south) \nÎ»: longitude (east/west) \nh: ellipsoidal height [km]\n\nhttps://www.wikipedia.org/wiki/Geodetic_coordinates\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.GDZ-2","page":"Home","title":"GeoCotrans.GDZ","text":"Geodetic (GDZ) coordinate system (latitude [deg], longitude [deg], altitude [km]).\n\nDefined using a reference ellipsoid. Both the altitude and latitude depend on the ellipsoid used. GeoCotrans uses the WGS84 reference ellipsoid.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.car2sph-Union{Tuple{T}, Tuple{T, T, T}} where T","page":"Home","title":"GeoCotrans.car2sph","text":"car2sph(x, y, z) -> (r, Î¸, Ï†)\n\nConvert Cartesian coordinates to spherical coordinates with angles in radians.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.car2sphd-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.car2sphd","text":"car2sphd(x, y, z) -> (r, Î¸, Ï†)\n\nConvert Cartesian coordinate to spherical coordinate with angles in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gdz2sph-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.gdz2sph","text":"gdz2sph(lat, lon, alt)\n\nConvert (lat [deg], lon [deg], alt [km]) in Geodetic coordinate to Spherical geocentric coordinate (r [Re], Î¸ [rad], Ï• [rad]).\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gei2geo","page":"Home","title":"GeoCotrans.gei2geo","text":"gei2geo(x, t)\n\nTransforms coordinate(s) x from Geocentric Equatorial Inertial (GEI) to Geographic (GEO) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gei2gsm","page":"Home","title":"GeoCotrans.gei2gsm","text":"gei2gsm(x, t)\n\nTransforms coordinate(s) x from Geocentric Equatorial Inertial (GEI) to Geocentric Solar Magnetospheric (GSM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gei2mag","page":"Home","title":"GeoCotrans.gei2mag","text":"gei2mag(x, t)\n\nTransforms coordinate(s) x from Geocentric Equatorial Inertial (GEI) to Geomagnetic (MAG) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gei2sm","page":"Home","title":"GeoCotrans.gei2sm","text":"gei2sm(x, t)\n\nTransforms coordinate(s) x from Geocentric Equatorial Inertial (GEI) to Solar Magnetic (SM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.geo2gei","page":"Home","title":"GeoCotrans.geo2gei","text":"geo2gei(x, t)\n\nTransforms coordinate(s) x from Geographic (GEO) to Geocentric Equatorial Inertial (GEI) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.geo2gsm","page":"Home","title":"GeoCotrans.geo2gsm","text":"geo2gsm(x, t)\n\nTransforms coordinate(s) x from Geographic (GEO) to Geocentric Solar Magnetospheric (GSM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.geo2mag","page":"Home","title":"GeoCotrans.geo2mag","text":"geo2mag(x, t)\n\nTransforms coordinate(s) x from Geographic (GEO) to Geomagnetic (MAG) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.geo2sm","page":"Home","title":"GeoCotrans.geo2sm","text":"geo2sm(x, t)\n\nTransforms coordinate(s) x from Geographic (GEO) to Solar Magnetic (SM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.get_igrf_coeffs-Tuple{Any}","page":"Home","title":"GeoCotrans.get_igrf_coeffs","text":"get_igrf_coeffs(time)\n\nGet IGRF-14 coefficients for a given time.\n\nSimilar to IRBEM implementation, but with higher precision (IRBEM uses year as the time unit).\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.get_mlt-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.get_mlt","text":"get_mlt(xGEO, time)\n\nCompute magnetic local time (MLT) in hours in the range [0, 24). \n\nMLT is computed from the difference between the magnetic longitudes of the position and the subsolar direction in MAG coordinates.\n\nIRBEM implementation\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gse2gsm","page":"Home","title":"GeoCotrans.gse2gsm","text":"gse2gsm(x, t)\n\nTransforms coordinate(s) x from Geocentric Solar Ecliptic (GSE) to Geocentric Solar Magnetospheric (GSM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gsm2gei","page":"Home","title":"GeoCotrans.gsm2gei","text":"gsm2gei(x, t)\n\nTransforms coordinate(s) x from Geocentric Solar Magnetospheric (GSM) to Geocentric Equatorial Inertial (GEI) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gsm2geo","page":"Home","title":"GeoCotrans.gsm2geo","text":"gsm2geo(x, t)\n\nTransforms coordinate(s) x from Geocentric Solar Magnetospheric (GSM) to Geographic (GEO) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gsm2gse","page":"Home","title":"GeoCotrans.gsm2gse","text":"gsm2gse(x, t)\n\nTransforms coordinate(s) x from Geocentric Solar Magnetospheric (GSM) to Geocentric Solar Ecliptic (GSE) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gsm2sm","page":"Home","title":"GeoCotrans.gsm2sm","text":"gsm2sm(x, t)\n\nTransforms coordinate(s) x from Geocentric Solar Magnetospheric (GSM) to Solar Magnetic (SM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.igrf-Tuple","page":"Home","title":"GeoCotrans.igrf","text":"igrf(ð«, t; kw...) = IGRF()(ð«, t; kw...)\n\nA convenience function for IGRF().\n\nCalculate IGRF model given coordinate(s) ð« at time(s) t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.igrf_B-NTuple{4, Any}","page":"Home","title":"GeoCotrans.igrf_B","text":"igrf_B(r, Î¸, Ï†, t; max_degree=IGRF_degree) -> (Br, BÎ¸, BÏ†)\n\nCalculate IGRF model components in geocentric coordinates (r [Re], Î¸ [rad], Ï† [rad]) at time t.\n\nr is the radius in Earth radii (Re), Î¸ is the colatitude in degrees, and Ï† is the longitude in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.mag2gei","page":"Home","title":"GeoCotrans.mag2gei","text":"mag2gei(x, t)\n\nTransforms coordinate(s) x from Geomagnetic (MAG) to Geocentric Equatorial Inertial (GEI) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.mag2geo","page":"Home","title":"GeoCotrans.mag2geo","text":"mag2geo(x, t)\n\nTransforms coordinate(s) x from Geomagnetic (MAG) to Geographic (GEO) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.mag2sm","page":"Home","title":"GeoCotrans.mag2sm","text":"mag2sm(x, t)\n\nTransforms coordinate(s) x from Geomagnetic (MAG) to Solar Magnetic (SM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.sm2gei","page":"Home","title":"GeoCotrans.sm2gei","text":"sm2gei(x, t)\n\nTransforms coordinate(s) x from Solar Magnetic (SM) to Geocentric Equatorial Inertial (GEI) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.sm2geo","page":"Home","title":"GeoCotrans.sm2geo","text":"sm2geo(x, t)\n\nTransforms coordinate(s) x from Solar Magnetic (SM) to Geographic (GEO) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.sm2gsm","page":"Home","title":"GeoCotrans.sm2gsm","text":"sm2gsm(x, t)\n\nTransforms coordinate(s) x from Solar Magnetic (SM) to Geocentric Solar Magnetospheric (GSM) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.sm2mag","page":"Home","title":"GeoCotrans.sm2mag","text":"sm2mag(x, t)\n\nTransforms coordinate(s) x from Solar Magnetic (SM) to Geomagnetic (MAG) reference frame at time(s) t.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.sph2car-NTuple{6, Any}","page":"Home","title":"GeoCotrans.sph2car","text":"Calculates cartesian field components from spherical ones\n\ntheta and phi are spherical angles of the point in radians\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.sph2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.sph2car","text":"sph2car(r, Î¸, Ï†) -> (x, y, z)\n\nConvert spherical coordinates to Cartesian coordinates.\n\nArguments\n\nr: radial distance\nÎ¸: colatitude in radians [0, Ï€]\nÏ†: east longitude in radians [0, 2Ï€]\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.sphd2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.sphd2car","text":"sphd2car(r, Î¸, Ï†) -> (x, y, z)\n\nConvert spherical coordinates to Cartesian coordinates, with angles in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.FieldLineTracing","page":"Home","title":"GeoCotrans.FieldLineTracing","text":"GeoCotrans.jl provides functionality to trace magnetic field lines.\n\nThis feature is provided via a package extension and requires an ODE solver package to be loaded in the active environment. For example, load OrdinaryDiffEqTsit5 (or another SciML ODE solver) before calling trace.\n\nAPI\n\ntrace, FieldLineProblem, FieldLineCallback\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.FieldLineTracing.FieldLineCallback","page":"Home","title":"GeoCotrans.FieldLineTracing.FieldLineCallback","text":"FieldLineCallback(; r0=1.0, rlim=10.0)\n\nCreate a callback for terminating field line integration at boundaries.\n\nKeyword Arguments\n\nr0 = 1.0: Inner radial boundary (Earth radii)\nrlim = 10.0: Outer radial boundary (Earth radii)\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.FieldLineTracing.FieldLineProblem","page":"Home","title":"GeoCotrans.FieldLineTracing.FieldLineProblem","text":"FieldLineProblem(pos, tspan, t; model=IGRF(), dir=1)\n\nCreate an ODEProblem for tracing a magnetic field line in model at time t.\n\ndir::Int = 1: Tracing direction (+1 for parallel to B, -1 for anti-parallel)\n\nExample\n\nusing GeoCotrans, OrdinaryDiffEqTsit5, Dates\n\nt = DateTime(2020, 1, 1)\npos = [3.0, 0.0, 0.0]\nprob = FieldLineProblem(pos, (0.0, 50.0), t)\nsol = solve(prob, Tsit5())\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.FieldLineTracing.trace","page":"Home","title":"GeoCotrans.FieldLineTracing.trace","text":"trace(pos, t, solver; kwargs...) :: ODESolution\n\nTrace a magnetic field line using the specified SciML solver.\n\nKeyword Arguments\n\nmodel = IGRF(): Magnetic field model to use\ndir = 1: Tracing direction (+1 for parallel to B, -1 for anti-parallel)\nr0 = 1.0: Inner radial boundary (Earth radii)\nrlim = 10.0: Outer radial boundary (Earth radii)\nmaxs = 100.0: Maximum arc length for integration\nin = getcsys(pos): Input coordinate system (Reference frame and coordinate representation)\nAdditional keyword arguments are passed to solve()\n\nExample\n\nusing GeoCotrans, OrdinaryDiffEqTsit5\nsol = trace([3.0, 0.0, 0.0], t, Tsit5())\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.calc_dipole_angle-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.calc_dipole_angle","text":"calc_dipole_angle(g10, g11, h11)\n\nCalculate dipole angle (Î¸, Ï†) and dipole strength (b0) from spherical harmonic coefficients g10, g11, h11.\n\nÎ¸: dipole tilt angle (radians) Ï†: dipole longitude/phase (radians) b0: dipole strength (nT)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calc_dipole_geo-Tuple{Any}","page":"Home","title":"GeoCotrans.calc_dipole_geo","text":"calc_dipole_geo(time)\n\nCompute dipole direction in GEO coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calc_sun_gei-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.calc_sun_gei","text":"calc_sun_gei(ra, dec)\n\nCalculate sun direction vector in GEI given right ascension ra and declination dec.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calculate_gst_alt-Tuple{Any}","page":"Home","title":"GeoCotrans.calculate_gst_alt","text":"calculate_gst_alt(time)\n\nAlternative implementation of Greenwich sidereal time calculation based on the reference algorithm from pyspedas.cotrans_tools.csundir_vect.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.car2gdz-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.car2gdz","text":"car2gdz(x, y, z; scale=RðŸœ¨)\n\nConvert Cartesian GEO coordinates (x, y, z) to Geodetic coordinates (Ï† [deg], Î» [deg], h [km]).\n\nUses Bowring's formula (1976). The input coordinates are assumed to be in units of scale (default: Earth radii).\n\nReference: \n\nhttps://en.wikipedia.org/wiki/Geodetic_coordinates\nhttps://github.com/JuliaEarth/CoordRefSystems.jl/blob/main/src/crs/geographic/geodetic.jl#L197\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.csundir-Tuple{Any}","page":"Home","title":"GeoCotrans.csundir","text":"csundir(time) -> (gst, ra, dec, elong, obliq)\n\nCalculate the direction of the sun, returns a tuple of (gst, ra, dec, elong, obliq) in radians.\n\ngst: Greenwich mean sidereal time\nra: Right ascension\ndec: Declination of the sun\nelong: ecliptic longitude\nobliq: Inclination of Earth's axis\n\nSee also AstroLib.sunpos.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.dipole_tilt-Tuple{Any}","page":"Home","title":"GeoCotrans.dipole_tilt","text":"dipole_tilt(time)\n\nCompute the dipole tilt angle Î¼ (in radians).\n\nThe dipole tilt is the angle between the dipole axis and the GSM Z-axis, positive when the north magnetic pole is tilted toward the Sun.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.evalsph","page":"Home","title":"GeoCotrans.evalsph","text":"evalsph(coeffs, r, Î¸, Ï†)\n\nEvaluate the magnetic field at a point in spherical coordinates.\n\nArguments\n\ncoeffs: The magnetic field coefficients\nr: Radial distance in planetary radii (dimensionless)\nÎ¸: Colatitude in radians [0, Ï€]\nÏ†: East longitude in radians [0, 2Ï€]\n\nReturns\n\nSVector{3,Float64}: Magnetic field vector [Br, BÎ¸, B_Ï†] in nanoTesla\n\nCoordinate System\n\nSpherical coordinates (r, Î¸, Ï†) where:\nr: radial distance from planet center\nÎ¸: colatitude (0 at north pole, Ï€ at south pole)\nÏ†: east longitude (0 at prime meridian, increases eastward)\n\nMathematical Formulation\n\nThe magnetic field is derived from the scalar potential:\n\nB_r = -fracVr quad\nB_Î¸ = -frac1rfracVÎ¸ quad\nB_Ï† = -frac1rsin Î¸fracVÏ†\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gdz2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.gdz2car","text":"gdz2car(Ï†, Î», h; scale=RðŸœ¨)\n\nConvert (Ï† [deg], Î» [deg], h [km]) in Geodetic coordinate to Cartesian GEO coordinate (x [Re], y [Re], z [Re]).\n\nUses the standard conversion formula from Wikipedia:\n\nX = (N + h) * cos(Ï†) * cos(Î»)\nY = (N + h) * cos(Ï†) * sin(Î»)\nZ = (N * (bÂ²/aÂ²) + h) * sin(Ï†)\n\nwhere N is the prime vertical radius of curvature: N = aÂ² / âˆš(aÂ² cosÂ²(Ï†) + bÂ² sinÂ²(Ï†))\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gei2gsm_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.gei2gsm_mat","text":"gei2gsm_mat(time)\n\nCompute the GEI to GSM transformation matrix.\n\nFirst axis: sun direction (xS, yS, zS) Second axis: y-axis (cross product of dipole and sun, normalized) Third axis: z-axis (cross product of sun and y-axis, normalized)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.geo2mag_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.geo2mag_mat","text":"geo2mag_mat(time)\n\nCompute the GEO to MAG transformation matrix.\n\nThis follows Hapgood (1992) / UCL geo_tran convention:\n\nT5 = <lat-90, Y> * <long, Z>\n\nwhere lat/long are the dipole pole coordinates from the IGRF dipole terms. With dipole colatitude Î¸ = Ï€/2 - lat and dipole longitude Ï† = long, this can be written as R_y(Î¸) * R_z(-Ï†).\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.get_dipole_terms-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.get_dipole_terms","text":"get_dipole_terms(g, h)\n\nCompute dipole parameters (Î¸, Ï†, x0, y0, z0, b0) from IGRF coefficients.\n\nReturns a named tuple: (Î¸, Ï†, x0, y0, z0, b0)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gse2gsm_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.gse2gsm_mat","text":"gse2gsm_mat(time)\n\nCompute the GSE to GSM transformation matrix T3 = <- psi,X>,  where the rotation angle psi is the GSE-GSM angle.\n\nThis transformation is a rotation in the GSE YZ plane from the GSE Z axis to the GSM Z axis.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gsm2sm_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.gsm2sm_mat","text":"gsm2sm_mat(time)\n\nCompute the GSM to SM transformation matrix.\n\nThe transformation is a simple rotation around the Y-axis by the dipole tilt angle Î¼. GSM and SM share the same Y-axis (perpendicular to the dipole-sun plane).\n\n\n\n\n\n","category":"method"}]
}
