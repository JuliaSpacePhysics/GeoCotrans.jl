var documenterSearchIndex = {"docs":
[{"location":"coords/#Compare-Coordinate-Transformations-with-IRBEM-and-PySPEDAS","page":"Validation & Comparison","title":"Compare Coordinate Transformations with IRBEM and PySPEDAS","text":"note: Takeaway\nJulia's implementation yields results very close to IRBEM's and PySPEDAS's one, and is an order of magnitude faster. (Julia's one uses finer interpolation than IRBEM's and PySPEDAS's one to determine IGRF coefficients and sun's direction, leading to more accurate transformations.)\n\nSee Coordinate Systems for more information about integration with SPEDAS.jl.\n\nReferences: test_cotrans.py - PySPEDAS","category":"section"},{"location":"coords/#Setup","page":"Validation & Comparison","title":"Setup","text":"details: Setup library dependencies\nusing GeoCotrans\nusing PySPEDAS\nusing PySPEDAS.PythonCall\nusing DimensionalData\nusing Chairmarks\nusing Test\nusing IRBEM\n\nfunction irbem_cotrans(pos, in, out)\n    IRBEM.transform(pos.dims[1].val, pos.data', in, out)'\nend\n\nUsing data from PySPEDAS test cases.\n\n@py import pyspedas.cotrans_tools.tests.test_cotrans: CotransTestCases\n\npytest = CotransTestCases()\npytest.test_cotrans()\n\ntrange = [\"2010-02-25/00:00:00\", \"2010-02-25/23:59:59\"]\npyspedas.projects.themis.state(trange, probe=\"a\", time_clip=true)\n\ntha_pos = PySPEDAS.get_data(\"tha_pos\") |> DimArray\ntha_pos_gse = PySPEDAS.get_data(\"tha_pos_gse\") |> DimArray\njl_tha_pos = set(tha_pos, Dim{:time}=>Ti)\njl_tha_pos_gse = set(tha_pos_gse, Dim{:time}=>Ti)","category":"section"},{"location":"coords/#Validation","page":"Validation & Comparison","title":"Validation","text":"Transform coordinates using Julia native implementation, IRBEM, and PySPEDAS.\n\nGEI <-> GEO\n\njl_tha_pos_geo = gei2geo(jl_tha_pos)\nir_tha_pos_geo = irbem_cotrans(jl_tha_pos, \"GEI\", \"GEO\")\npy_tha_pos_geo = PySPEDAS.get_data(\"tha_pos_new_geo\")\n\n@assert jl_tha_pos_geo â‰ˆ parent(py_tha_pos_geo)\n@assert jl_tha_pos_geo â‰ˆ ir_tha_pos_geo\n\nGEI <-> GSM\n\njl_tha_pos_gsm = gei2gsm(jl_tha_pos)\nir_tha_pos_gsm = irbem_cotrans(jl_tha_pos, \"GEI\", \"GSM\")\npyspedas.cotrans(\"tha_pos\", \"tha_pos_new_gsm\", coord_in=\"GEI\", coord_out=\"GSM\")\npy_tha_pos_gsm = PySPEDAS.get_data(\"tha_pos_new_gsm\")\n\n@test isapprox(jl_tha_pos_gsm, parent(py_tha_pos_gsm), rtol=1e-5)\n@test isapprox(jl_tha_pos_gsm, ir_tha_pos_gsm, rtol=1e-3)\n\nGSE <-> GSM\n\njl_tha_pos_gsm = gse2gsm(jl_tha_pos_gse)\nir_tha_pos_gsm = irbem_cotrans(jl_tha_pos_gse, \"GSE\", \"GSM\")\npyspedas.cotrans(\"tha_pos_gse\", \"tha_pos_new_gsm\", coord_in=\"GSE\", coord_out=\"GSM\")\npy_tha_pos_gsm = PySPEDAS.get_data(\"tha_pos_new_gsm\")\n\n@test isapprox(jl_tha_pos_gsm, parent(py_tha_pos_gsm), rtol=1e-5)\n@test isapprox(jl_tha_pos_gsm, ir_tha_pos_gsm, rtol=1e-3)\n\nValidate results: GEI/GEO transformations is quite accurate, while there are some differences in GSE/GSM transformations between Julia native implementation and IRBEM's one.","category":"section"},{"location":"coords/#Benchmark","page":"Validation & Comparison","title":"Benchmark","text":"Depends on the transformation, Julia's implementation is about 10-40 times faster than IRBEM's (Fortran) implementation, and 20-50 times faster than PySPEDAS's (Python) implementation.\n\n@b gei2geo($jl_tha_pos), irbem_cotrans($jl_tha_pos, \"GEI\", \"GEO\"), pyspedas.cotrans(\"tha_pos\", \"tha_pos_new_geo\", coord_in=\"GEI\", coord_out=\"GEO\")\n\n@b gei2gsm($jl_tha_pos), irbem_cotrans($jl_tha_pos, \"GEI\", \"GSM\"), pyspedas.cotrans(\"tha_pos\", \"tha_pos_new_gsm\", coord_in=\"GEI\", coord_out=\"GSM\")\n\n@b gse2gsm($jl_tha_pos_gse), irbem_cotrans($jl_tha_pos_gse, \"GSE\", \"GSM\"), pyspedas.cotrans(\"tha_pos_gse\", \"tha_pos_new_gsm\", coord_in=\"GSE\", coord_out=\"GSM\")","category":"section"},{"location":"#GeoCotrans.jl","page":"Home","title":"GeoCotrans.jl","text":"(Image: DOI) (Image: version)","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"using Pkg\nPkg.add(\"GeoCotrans\")","category":"section"},{"location":"#Coordinate-Systems","page":"Home","title":"Coordinate Systems","text":"","category":"section"},{"location":"#API-Reference","page":"Home","title":"API Reference","text":"","category":"section"},{"location":"#Public","page":"Home","title":"Public","text":"","category":"section"},{"location":"#Private","page":"Home","title":"Private","text":"","category":"section"},{"location":"#GeoCotrans","page":"Home","title":"GeoCotrans","text":"Coordinate systems, transformations, and geomagnetic field models.\n\nReference frames\n\nGEO: Geocentric Geographic (cartesian) (GEO) coordinate system (x [ð‹], y [ð‹], z [ð‹]).\nGSM: Geocentric Solar Magnetospheric (GSM) coordinate system.\nGSE: Geocentric Solar Ecliptic (GSE) coordinate system.\nGEI: Geocentric Equatorial Inertial (GEI) coordinate system.\nMAG: Geomagnetic (MAG) coordinate system.\n\nUtility functions for specifying coordinate representaion in GEO reference frames.\n\nGDZ: Geodetic (GDZ) coordinate system (altitude [ð‹], latitude [deg], longitude [deg]).\n\nCoordinate transformations\n\ngeo2gei, gei2geo: Transform between GEO and GEI reference frames.\ngeo2gsm, gsm2geo: Transform between GEO and GSM reference frames.\ngei2gsm, gsm2gei: Transform between GEI and GSM reference frames.\ngse2gsm, gsm2gse: Transform between GSE and GSM reference frames.\nsph2car, car2sph: Transform between spherical and cartesian coordinate representations.\n\nReferences\n\nCoordinate transformations between geocentric systems\n\nInternational Geomagnetic Reference Field (IGRF)\n\nThe International Geomagnetic Reference Field (IGRF) is a standard mathematical description of the Earth's main magnetic field. It is used widely in studies of the Earth's deep interior, crust, ionosphere, and magnetosphere.\n\nAPI\n\nIGRF / igrf: Compute the geomagnetic field (IGRF-14)\n\nExamples\n\nusing GeoCotrans, Dates\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = Date(2015)\nBr, BÎ¸, BÏ† = igrf(r, Î¸, Ï†, t) # â‰ˆ [-45469, -21942, 2933]\n\n# Input position in geodetic coordinates, output magnetic field in East-North-Up (ENU) coordinates\nlat, lon = 60, 5\nBe, Bn, Bu = igrf(GDZ(lat, lon), t) # [430, 15184, -48864]\n\n# Input position as a matrix in GSM Cartesian coordinates, output magnetic field as a matrix\npos = rand(3, 6)\ntimes = Date.(2015:2020)\nBgsm = igrf(pos, times; in = GSM())\n\nReferences\n\nIAGA - NOAA/NCEI\nIGRF-14 Evaluation\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.GEI-index","page":"Home","title":"GeoCotrans.GEI","text":"Geocentric Equatorial Inertial (GEI) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEO-index","page":"Home","title":"GeoCotrans.GEO","text":"Geocentric Geographic (cartesian) (GEO) coordinate system (x [ð‹], y [ð‹], z [ð‹]).\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSM-index","page":"Home","title":"GeoCotrans.GSM","text":"Geocentric Solar Magnetospheric (GSM) coordinate system.\n\nX points sunward from Earth's center. The X-Z plane is defined to contain Earth's dipole axis (positive North).\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSE-index","page":"Home","title":"GeoCotrans.GSE","text":"Geocentric Solar Ecliptic (GSE) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.MAG-index","page":"Home","title":"GeoCotrans.MAG","text":"Geomagnetic (MAG) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.SM-index","page":"Home","title":"GeoCotrans.SM","text":"Solar Magnetic (SM) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GDZ-index","page":"Home","title":"GeoCotrans.GDZ","text":"Geodetic (GDZ) coordinate system (altitude [ð‹], latitude [deg], longitude [deg]).\n\nDefined using a reference ellipsoid. Both the altitude and latitude depend on the ellipsoid used. GeoCotrans uses the WGS84 reference ellipsoid.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.GeoCotrans","page":"Home","title":"GeoCotrans.GeoCotrans","text":"Coordinate systems, transformations, and geomagnetic field models.\n\nReference frames\n\nGEO: Geocentric Geographic (cartesian) (GEO) coordinate system (x [ð‹], y [ð‹], z [ð‹]).\nGSM: Geocentric Solar Magnetospheric (GSM) coordinate system.\nGSE: Geocentric Solar Ecliptic (GSE) coordinate system.\nGEI: Geocentric Equatorial Inertial (GEI) coordinate system.\nMAG: Geomagnetic (MAG) coordinate system.\n\nUtility functions for specifying coordinate representaion in GEO reference frames.\n\nGDZ: Geodetic (GDZ) coordinate system (altitude [ð‹], latitude [deg], longitude [deg]).\n\nCoordinate transformations\n\ngeo2gei, gei2geo: Transform between GEO and GEI reference frames.\ngeo2gsm, gsm2geo: Transform between GEO and GSM reference frames.\ngei2gsm, gsm2gei: Transform between GEI and GSM reference frames.\ngse2gsm, gsm2gse: Transform between GSE and GSM reference frames.\nsph2car, car2sph: Transform between spherical and cartesian coordinate representations.\n\nReferences\n\nCoordinate transformations between geocentric systems\n\nInternational Geomagnetic Reference Field (IGRF)\n\nThe International Geomagnetic Reference Field (IGRF) is a standard mathematical description of the Earth's main magnetic field. It is used widely in studies of the Earth's deep interior, crust, ionosphere, and magnetosphere.\n\nAPI\n\nIGRF / igrf: Compute the geomagnetic field (IGRF-14)\n\nExamples\n\nusing GeoCotrans, Dates\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = Date(2015)\nBr, BÎ¸, BÏ† = igrf(r, Î¸, Ï†, t) # â‰ˆ [-45469, -21942, 2933]\n\n# Input position in geodetic coordinates, output magnetic field in East-North-Up (ENU) coordinates\nlat, lon = 60, 5\nBe, Bn, Bu = igrf(GDZ(lat, lon), t) # [430, 15184, -48864]\n\n# Input position as a matrix in GSM Cartesian coordinates, output magnetic field as a matrix\npos = rand(3, 6)\ntimes = Date.(2015:2020)\nBgsm = igrf(pos, times; in = GSM())\n\nReferences\n\nIAGA - NOAA/NCEI\nIGRF-14 Evaluation\n\n\n\n\n\n","category":"module"},{"location":"#GeoCotrans.CoordinateVector","page":"Home","title":"GeoCotrans.CoordinateVector","text":"CoordinateVector{F, T}\n\n3-element FieldVector in a specific coordinate frame F using representation R.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEI","page":"Home","title":"GeoCotrans.GEI","text":"Geocentric Equatorial Inertial (GEI) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEI-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.GEI","text":"GEI(x, y, z)\n\nConstruct a CoordinateVector in GEI coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GEI-Tuple{Any}","page":"Home","title":"GeoCotrans.GEI","text":"GEI(ð«)\n\nConstruct a CoordinateVector in GEI coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GEO","page":"Home","title":"GeoCotrans.GEO","text":"Geocentric Geographic (cartesian) (GEO) coordinate system (x [ð‹], y [ð‹], z [ð‹]).\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GEO-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.GEO","text":"GEO(x, y, z)\n\nConstruct a CoordinateVector in GEO coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GEO-Tuple{Any}","page":"Home","title":"GeoCotrans.GEO","text":"GEO(ð«)\n\nConstruct a CoordinateVector in GEO coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GSE","page":"Home","title":"GeoCotrans.GSE","text":"Geocentric Solar Ecliptic (GSE) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSE-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.GSE","text":"GSE(x, y, z)\n\nConstruct a CoordinateVector in GSE coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GSE-Tuple{Any}","page":"Home","title":"GeoCotrans.GSE","text":"GSE(ð«)\n\nConstruct a CoordinateVector in GSE coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GSM","page":"Home","title":"GeoCotrans.GSM","text":"Geocentric Solar Magnetospheric (GSM) coordinate system.\n\nX points sunward from Earth's center. The X-Z plane is defined to contain Earth's dipole axis (positive North).\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.GSM-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.GSM","text":"GSM(x, y, z)\n\nConstruct a CoordinateVector in GSM coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GSM-Tuple{Any}","page":"Home","title":"GeoCotrans.GSM","text":"GSM(ð«)\n\nConstruct a CoordinateVector in GSM coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.IGRF","page":"Home","title":"GeoCotrans.IGRF","text":"IGRF(; in = (GEO(), Spherical()))\n\nCreate an IGRF magnetic field model.     By default the input coordinate system in is (GEO(), Spherical()).\n\nExamples\n\nm = IGRF()\nr, Î¸, Ï† = 1.0, deg2rad(45), deg2rad(45)\nt = DateTime(\"2021-03-28\")\nm(r, Î¸, Ï†, t)\n\n# When input is in different coordinate system, specify `in` or decorate the input\n# By default, the output for GDZ input is (Be, Bn, Bu) in East-North-Up (ENU) frame\nlat, lon = 60.39299, 5.32415\nm2 = IGRF(; in = GDZ())\nm2(lat, lon, 0, t)\nm(GDZ(lat, lon, 0), t)\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.MAG","page":"Home","title":"GeoCotrans.MAG","text":"Geomagnetic (MAG) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.MAG-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.MAG","text":"MAG(x, y, z)\n\nConstruct a CoordinateVector in MAG coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.MAG-Tuple{Any}","page":"Home","title":"GeoCotrans.MAG","text":"MAG(ð«)\n\nConstruct a CoordinateVector in MAG coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.SM","page":"Home","title":"GeoCotrans.SM","text":"Solar Magnetic (SM) coordinate system.\n\n\n\n\n\n","category":"type"},{"location":"#GeoCotrans.SM-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.SM","text":"SM(x, y, z)\n\nConstruct a CoordinateVector in SM coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.SM-Tuple{Any}","page":"Home","title":"GeoCotrans.SM","text":"SM(ð«)\n\nConstruct a CoordinateVector in SM coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.GDZ","page":"Home","title":"GeoCotrans.GDZ","text":"GDZ(Ï•, Î», h)\n\nGeodetic coordinate system with:\n\nÏ•: latitude (north/south) \nÎ»: longitude (east/west) \nh: ellipsoidal height [km]\n\nhttps://www.wikipedia.org/wiki/Geodetic_coordinates\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.GDZ-2","page":"Home","title":"GeoCotrans.GDZ","text":"Geodetic (GDZ) coordinate system (altitude [ð‹], latitude [deg], longitude [deg]).\n\nDefined using a reference ellipsoid. Both the altitude and latitude depend on the ellipsoid used. GeoCotrans uses the WGS84 reference ellipsoid.\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.car2sph-Union{Tuple{T}, Tuple{T, T, T}} where T","page":"Home","title":"GeoCotrans.car2sph","text":"car2sph(x, y, z) -> (r, Î¸, Ï†)\n\nConvert Cartesian coordinates to spherical coordinates with angles in radians.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.car2sphd-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.car2sphd","text":"car2sphd(x, y, z) -> (r, Î¸, Ï†)\n\nConvert Cartesian coordinate to spherical coordinate with angles in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gdz2sph-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.gdz2sph","text":"gdz2sph(lat, lon, alt)\n\nConvert (lat [deg], lon [deg], alt [km]) in Geodetic coordinate to Spherical geocentric coordinate (r [Re], Î¸ [rad], Ï• [rad]).\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gei2geo-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gei2geo","text":"gei2geo(x, t)\n\nTransforms x vector from Geocentric Equatorial Inertial (GEI) to Geographic (GEO) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gei2gsm-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gei2gsm","text":"gei2gsm(x, t)\n\nTransforms x vector from Geocentric Equatorial Inertial (GEI) to Geocentric Solar Magnetic (GSM) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.geo2gei-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.geo2gei","text":"geo2gei(x, t)\n\nTransforms x vector from Geographic (GEO) to Geocentric Equatorial Inertial (GEI) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.geo2gsm-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.geo2gsm","text":"geo2gsm(x, t)\n\nTransforms x vector from Geographic (GEO) to Geocentric Solar Magnetic (GSM) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.get_igrf_coeffs-Tuple{Any}","page":"Home","title":"GeoCotrans.get_igrf_coeffs","text":"get_igrf_coeffs(time)\n\nGet IGRF-14 coefficients for a given time.\n\nSimilar to IRBEM implementation, but with higher precision (IRBEM uses year as the time unit).\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gse2gsm","page":"Home","title":"GeoCotrans.gse2gsm","text":"See also: gse2gsm_mat\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gse2gsm-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gse2gsm","text":"gse2gsm(x, t)\n\nTransforms x vector from Geocentric Solar Ecliptic (GSE) to Geocentric Solar Magnetic (GSM) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gsm2gei-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gsm2gei","text":"gsm2gei(x, t)\n\nTransforms x vector from Geocentric Solar Magnetic (GSM) to Geocentric Equatorial Inertial (GEI) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gsm2geo-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gsm2geo","text":"gsm2geo(x, t)\n\nTransforms x vector from Geocentric Solar Magnetic (GSM) to Geographic (GEO) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gsm2gse-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.gsm2gse","text":"gsm2gse(x, t)\n\nTransforms x vector from Geocentric Solar Magnetic (GSM) to Geocentric Solar Ecliptic (GSE) coordinates at time t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.igrf-Tuple","page":"Home","title":"GeoCotrans.igrf","text":"igrf(ð«, t; kw...) = IGRF()(ð«, t; kw...)\n\nA convenience function for IGRF().\n\nCalculate IGRF model given coordinate(s) ð« at time(s) t.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.igrf_B-NTuple{4, Any}","page":"Home","title":"GeoCotrans.igrf_B","text":"igrf_B(r, Î¸, Ï†, t; max_degree=IGRF_degree) -> (Br, BÎ¸, BÏ†)\n\nCalculate IGRF model components in geocentric coordinates (r [Re], Î¸ [rad], Ï† [rad]) at time t.\n\nr is the radius in Earth radii (Re), Î¸ is the colatitude in degrees, and Ï† is the longitude in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.sph2car-NTuple{6, Any}","page":"Home","title":"GeoCotrans.sph2car","text":"Calculates cartesian field components from spherical ones\n\ntheta and phi are spherical angles of the point in radians\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.sph2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.sph2car","text":"sph2car(r, Î¸, Ï†) -> (x, y, z)\n\nConvert spherical coordinates to Cartesian coordinates.\n\nArguments\n\nr: radial distance\nÎ¸: colatitude in radians [0, Ï€]\nÏ†: east longitude in radians [0, 2Ï€]\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.sphd2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.sphd2car","text":"sphd2car(r, Î¸, Ï†) -> (x, y, z)\n\nConvert spherical coordinates to Cartesian coordinates, with angles in degrees.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calc_dipole_angle-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.calc_dipole_angle","text":"calc_dipole_angle(g10, g11, h11)\n\nCalculate dipole angle (Î¸, Ï†) and dipole strength (b0) from spherical harmonic coefficients g10, g11, h11.\n\nÎ¸: dipole tilt angle (radians) Ï†: dipole longitude/phase (radians) b0: dipole strength (nT)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calc_dipole_geo-Tuple{Any}","page":"Home","title":"GeoCotrans.calc_dipole_geo","text":"calc_dipole_geo(time)\n\nCompute dipole direction in GEO coordinates.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calc_sun_gei-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.calc_sun_gei","text":"calc_sun_gei(ra, dec)\n\nCalculate sun direction vector in GEI given right ascension ra and declination dec.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.calculate_gst_alt-Tuple{Any}","page":"Home","title":"GeoCotrans.calculate_gst_alt","text":"calculate_gst_alt(time)\n\nAlternative implementation of Greenwich sidereal time calculation based on the reference algorithm from pyspedas.cotrans_tools.csundir_vect.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.car2gdz-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.car2gdz","text":"car2gdz(x, y, z; scale=RðŸœ¨)\n\nConvert Cartesian GEO coordinates (x, y, z) to Geodetic coordinates (Ï† [deg], Î» [deg], h [km]).\n\nUses Bowring's formula (1976). The input coordinates are assumed to be in units of scale (default: Earth radii).\n\nReference: \n\nhttps://en.wikipedia.org/wiki/Geodetic_coordinates\nhttps://github.com/JuliaEarth/CoordRefSystems.jl/blob/main/src/crs/geographic/geodetic.jl#L197\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.csundir-Tuple{Any}","page":"Home","title":"GeoCotrans.csundir","text":"csundir(time) -> (gst, ra, dec, elong, obliq)\n\nCalculate the direction of the sun, returns a tuple of (gst, ra, dec, elong, obliq) in radians.\n\ngst: Greenwich mean sidereal time\nra: Right ascension\ndec: Declination of the sun\nelong: ecliptic longitude\nobliq: Inclination of Earth's axis\n\nSee also AstroLib.sunpos.\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.evalsph","page":"Home","title":"GeoCotrans.evalsph","text":"evalsph(coeffs, r, Î¸, Ï†)\n\nEvaluate the magnetic field at a point in spherical coordinates.\n\nArguments\n\ncoeffs: The magnetic field coefficients\nr: Radial distance in planetary radii (dimensionless)\nÎ¸: Colatitude in radians [0, Ï€]\nÏ†: East longitude in radians [0, 2Ï€]\n\nReturns\n\nSVector{3,Float64}: Magnetic field vector [Br, BÎ¸, B_Ï†] in nanoTesla\n\nCoordinate System\n\nSpherical coordinates (r, Î¸, Ï†) where:\nr: radial distance from planet center\nÎ¸: colatitude (0 at north pole, Ï€ at south pole)\nÏ†: east longitude (0 at prime meridian, increases eastward)\n\nMathematical Formulation\n\nThe magnetic field is derived from the scalar potential:\n\nB_r = -fracVr quad\nB_Î¸ = -frac1rfracVÎ¸ quad\nB_Ï† = -frac1rsin Î¸fracVÏ†\n\n\n\n\n\n","category":"function"},{"location":"#GeoCotrans.gdz2car-Tuple{Any, Any, Any}","page":"Home","title":"GeoCotrans.gdz2car","text":"gdz2car(Ï†, Î», h; scale=RðŸœ¨)\n\nConvert (Ï† [deg], Î» [deg], h [km]) in Geodetic coordinate to Cartesian GEO coordinate (x [Re], y [Re], z [Re]).\n\nUses the standard conversion formula from Wikipedia:\n\nX = (N + h) * cos(Ï†) * cos(Î»)\nY = (N + h) * cos(Ï†) * sin(Î»)\nZ = (N * (bÂ²/aÂ²) + h) * sin(Ï†)\n\nwhere N is the prime vertical radius of curvature: N = aÂ² / âˆš(aÂ² cosÂ²(Ï†) + bÂ² sinÂ²(Ï†))\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gei2gsm_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.gei2gsm_mat","text":"gei2gsm_mat(time)\n\nCompute the GEI to GSM transformation matrix.\n\nFirst axis: sun direction (xS, yS, zS) Second axis: y-axis (cross product of dipole and sun, normalized) Third axis: z-axis (cross product of sun and y-axis, normalized)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.get_dipole_terms-Tuple{Any, Any}","page":"Home","title":"GeoCotrans.get_dipole_terms","text":"get_dipole_terms(g, h)\n\nCompute dipole parameters (Î¸, Ï†, x0, y0, z0, b0) from IGRF coefficients.\n\nReturns a named tuple: (Î¸, Ï†, x0, y0, z0, b0)\n\n\n\n\n\n","category":"method"},{"location":"#GeoCotrans.gse2gsm_mat-Tuple{Any}","page":"Home","title":"GeoCotrans.gse2gsm_mat","text":"gse2gsm_mat(time)\n\nCompute the GSE to GSM transformation matrix T3 = <- psi,X>,  where the rotation angle psi is the GSE-GSM angle.\n\nThis transformation is a rotation in the GSE YZ plane from the GSE Z axis to the GSM Z axis.\n\n\n\n\n\n","category":"method"}]
}
